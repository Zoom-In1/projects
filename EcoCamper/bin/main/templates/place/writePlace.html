<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ì¥ì†Œ ì…ë ¥</title>
<!-- ì™¸ë¶€ CSS ë¡œë“œ -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.fluid.classless.jade.min.css">

<style>
  .star-clean, .star-scene, .star-independence, .star-facility, .star-editor {
    width: 24px;  /* ì›í•˜ëŠ” ë„ˆë¹„ */
    height: 24px; /* ì›í•˜ëŠ” ë†’ì´ */
  }
  
  #emoji-container2, #emoji-container3 {
      display: flex;
      flex-wrap: wrap;  /* ì¤„ë°”ê¿ˆ í—ˆìš© */
      justify-content: center;  /* ì¤‘ì•™ ì •ë ¬ */
      gap: 10px;  /* ì´ëª¨ì§€ ì‚¬ì´ ê°„ê²© */
      max-width: 1400px;  /* í•œ ì¤„ì— ë“¤ì–´ê°ˆ ìµœëŒ€ ë„ˆë¹„ ì„¤ì • (í•„ìš”ì— ë”°ë¼ ì¡°ì ˆ ê°€ëŠ¥) */
  }
  
  .emoji {
      font-size: 24px;
      cursor: pointer;
  }
  
  #place_keypoint, #place_precaution {
  	height: 200px;
  }

</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const saveSuccess = new URLSearchParams(window.location.search).get('saveSuccess');
    if (saveSuccess === 'true') {
      alert('ì €ì¥ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
    } else if (saveSuccess === 'false') {
      alert('ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
    }
  });
</script>

</head>
<body>
    <main class="container">
        <h1>Map ë°ì´í„° ì…ë ¥</h1>
        <form id="mapForm" action="/savePlace" method="post">
            <!-- ì¥ì†Œ ì¹´í…Œê³ ë¦¬ -->
            <label for="place_category">ì¥ì†Œ ì¹´í…Œê³ ë¦¬</label>
            <select id="place_category" name="place_category" required aria-invalid="true">
                <option value="">ì¥ì†Œ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                <option value="place_c01">ìº í•‘ì¥</option>
                <option value="place_c02">ì°¨ë°•, ë…¸ì§€</option>
                <option value="place_c03">ê¸€ë¨í•‘, ì¹´ë¼ë°˜</option>
                <option value="place_c04">ë°±íŒ¨í‚¹, í•˜ì´í‚¹</option>
                <option value="place_c05">ë‚šì‹œìŠ¤íŒŸ</option>
                <option value="place_c06">ì—¬í–‰</option>
                <option value="place_c07">ì•¡í‹°ë¹„í‹°</option>
                <option value="place_c08">ì›Œí„°ìŠ¤í¬ì¸ </option>
                <option value="place_c09">ìŠ¤í† ì–´</option>
            </select>

            <!-- ì¥ì†Œëª… -->
            <label for="place_name">ì¥ì†Œëª…</label>
            <input type="text" id="place_name" name="place_name" aria-invalid="true"><br>

            <!-- ì£¼ì†Œ -->
            <label for="place_address">ì£¼ì†Œ</label>
            <input type="text" id="place_address" name="place_address" aria-invalid="true"><br>
            
            <!-- ìš°í¸ë²ˆí˜¸ -->
            <label for="place_postcode">ìš°í¸ë²ˆí˜¸</label>
            <input type="text" id="place_postcode" name="place_postcode"><br>

            <!-- ì§€ë²ˆ -->
            <label for="place_oldaddr">ì§€ë²ˆ</label>
            <input type="text" id="place_oldaddr" name="place_oldaddr"><br>

            <!-- ì‚¬ì§„ -->
            <label for="place_pic">ëŒ€í‘œ ì‚¬ì§„ (url)</label>
            <input type="text" id="place_pic" name="place_pic"><br>

            <!-- ì„¤ëª… -->
            <label for="place_description">ì¥ì†Œ ì„¤ëª…</label>
            <textarea id="place_description" name="place_description" aria-invalid="true"></textarea><br>

            <!-- ì£¼ìš”ì‚¬í•­ -->
            <label for="place_keypoint">ì£¼ìš”ì‚¬í•­</label>
            <textarea id="place_keypoint" name="place_keypoint"></textarea>
            <!-- ì´ëª¨ì§€ ì„ íƒ ì˜ì—­ -->
			<div id="emoji-container2"></div><br>
            <br>

            <!-- ì£¼ì˜ì‚¬í•­ -->
            <label for="place_precaution"> ì´ìš©ê° ì£¼ì˜ì‚¬í•­</label>
            <textarea id="place_precaution" name="place_precaution"></textarea>
            <!-- ì´ëª¨ì§€ ì„ íƒ ì˜ì—­ -->
			<div id="emoji-container3"></div><br>
            <br>

            <!-- ì˜ˆì•½ ë§í¬ -->
            <label for="place_bookingLink">ì˜ˆì•½ ë§í¬ (í™ˆí˜ì´ì§€ ë§í¬)</label>
            <input type="text" id="place_bookingLink" name="place_bookingLink"><br>

            <!-- ì „í™”ë²ˆí˜¸ -->
            <label for="place_tel">ì „í™”ë²ˆí˜¸</label>
            <input type="text" id="place_tel" name="place_tel"><br>
			
			<!-- ì²­ê²°ë„ -->
			<label for="place_cleanscore">ì²­ê²°ë„</label>
			<div id="cleanscore">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„1" class="star-clean" data-value="1">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„2" class="star-clean" data-value="2">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„3" class="star-clean" data-value="3">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„4" class="star-clean" data-value="4">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„5" class="star-clean" data-value="5">
			</div>
			<input type="hidden" id="place_cleanscore" name="place_cleanscore" value="0"><br>
			
			<!-- ê²½ì¹˜ -->
			<label for="place_scenescore">ê²½ì¹˜</label>
			<div id="scenescore">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„1" class="star-scene" data-value="1">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„2" class="star-scene" data-value="2">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„3" class="star-scene" data-value="3">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„4" class="star-scene" data-value="4">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„5" class="star-scene" data-value="5">
			</div>
			<input type="hidden" id="place_scenescore" name="place_scenescore" value="0"><br>
			
			<!-- ë…ë¦½ì„± -->
			<label for="place_independencescore">ë…ë¦½ì„±</label>
			<div id="independencescore">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„1" class="star-independence" data-value="1">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„2" class="star-independence" data-value="2">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„3" class="star-independence" data-value="3">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„4" class="star-independence" data-value="4">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„5" class="star-independence" data-value="5">
			</div>
			<input type="hidden" id="place_independencescore" name="place_independencescore" value="0"><br>
			
			<!-- ì‹œì„¤ ì ìˆ˜ -->
			<label for="place_facilityscore">ì‹œì„¤ ì ìˆ˜</label>
			<div id="facilityscore">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„1" class="star-facility" data-value="1">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„2" class="star-facility" data-value="2">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„3" class="star-facility" data-value="3">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„4" class="star-facility" data-value="4">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„5" class="star-facility" data-value="5">
			</div>
			<input type="hidden" id="place_facilityscore" name="place_facilityscore" value="0"><br>

			<!-- ì—ë””í„° í‰ì  (ìë™ ê³„ì‚°) -->
			<label for="place_editorscore">ì—ë””í„° í‰ì </label>
			<div id="editorscore">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„1" class="star-editor" data-value="1">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„2" class="star-editor" data-value="2">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„3" class="star-editor" data-value="3">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„4" class="star-editor" data-value="4">
			    <img src="https://cdn-icons-png.flaticon.com/128/2377/2377878.png" alt="ë³„5" class="star-editor" data-value="5">
			</div>
			<input type="hidden" id="place_editorscore" name="place_editorscore" value="0"><br>

            <!-- í¸ì˜ì‹œì„¤ -->
            <fieldset>
                <legend>í¸ì˜ì‹œì„¤</legend>
                <label><input type="checkbox" name="place_facility" value="place_f01"> í™”ì¥ì‹¤</label>
                <label><input type="checkbox" name="place_facility" value="place_f02"> ìƒ¤ì›Œì‹¤</label>
                <label><input type="checkbox" name="place_facility" value="place_f03"> ë§¤ì </label>
                <label><input type="checkbox" name="place_facility" value="place_f04"> ë‚šì‹œ</label>
                <label><input type="checkbox" name="place_facility" value="place_f05"> ê°œìˆ˜ëŒ€</label>
                <label><input type="checkbox" name="place_facility" value="place_f06"> ì „ê¸°ì‚¬ìš©</label>
                <label><input type="checkbox" name="place_facility" value="place_f07"> ì¥ë¹„ëŒ€ì—¬</label>
                <label><input type="checkbox" name="place_facility" value="place_f08"> ìˆ˜ì˜ì¥</label>
                <label><input type="checkbox" name="place_facility" value="place_f09"> ë·°ë§›ì§‘</label>
                <label><input type="checkbox" name="place_facility" value="place_f10"> ì²´í—˜ í”„ë¡œê·¸ë¨</label>
                <label><input type="checkbox" name="place_facility" value="place_f11"> ë†€ì´ì‹œì„¤</label>
                <label><input type="checkbox" name="place_facility" value="place_f12"> ì•¡í‹°ë¹„í‹°</label>
                <label><input type="checkbox" name="place_facility" value="place_f13"> ë…¸í‚¤ì¦ˆ</label>
                <label><input type="checkbox" name="place_facility" value="place_f14"> ë°˜ë ¤ê²¬ ë™ë°˜</label>
                <label><input type="checkbox" name="place_facility" value="place_f15"> ë°©ì†¡ì¶œì—°</label>
                <label><input type="checkbox" name="place_facility" value="place_f16"> ì—ì–´ì»¨</label>
                <label><input type="checkbox" name="place_facility" value="place_f17"> ì£¼ì°¨</label>
            </fieldset>

            <!-- ì£¼ë³€ í™˜ê²½ -->
            <fieldset>
                <legend>ì£¼ë³€ í™˜ê²½</legend>
                <label><input type="checkbox" name="place_environment" value="place_e01"> ë°”ë‹¤</label>
                <label><input type="checkbox" name="place_environment" value="place_e02"> í˜¸ìˆ˜, ê°•</label>
                <label><input type="checkbox" name="place_environment" value="place_e03"> ê³„ê³¡</label>
                <label><input type="checkbox" name="place_environment" value="place_e04"> ì‚°, ìˆ²</label>
                <label><input type="checkbox" name="place_environment" value="place_e05"> ì„¬</label>
                <label><input type="checkbox" name="place_environment" value="place_e06"> ê³µì›, ìœ ì›ì§€</label>
                <label><input type="checkbox" name="place_environment" value="place_e07"> ë„ì‹¬</label>
                <label><input type="checkbox" name="place_environment" value="place_e08"> ë†ì´Œ</label>
            </fieldset>

            <!-- ê³„ì ˆ -->
            <fieldset>
                <legend>ë°©ë¬¸í•˜ê¸° ì¢‹ì€ ê³„ì ˆ (ì¶”ì²œ)</legend>
                <label><input type="checkbox" name="place_season" value="place_s01"> ë´„</label>
                <label><input type="checkbox" name="place_season" value="place_s02"> ì—¬ë¦„</label>
                <label><input type="checkbox" name="place_season" value="place_s03"> ê°€ì„</label>
                <label><input type="checkbox" name="place_season" value="place_s04"> ê²¨ìš¸</label>
            </fieldset>

            <!-- ìœ íŠœë¸Œ ë§í¬ -->
            <label for="place_youtubeLink">ìœ íŠœë¸Œ ë§í¬</label>
            <input type="text" id="place_youtubeLink" name="place_youtubeLink"><br>

            <!-- ìœ íŠœë¸Œ ì œëª© -->
            <label for="place_youtubeTitle">ìœ íŠœë¸Œ ì œëª©</label>
            <input type="text" id="place_youtubeTitle" name="place_youtubeTitle"><br>

            <!-- ìœ íŠœë¸Œ ì¸ë„¤ì¼ -->
            <label for="place_youtubeVideo">ìœ íŠœë¸Œ ì¸ë„¤ì¼</label>
            <input type="text" id="place_youtubeVideo" name="place_youtubeVideo"><br>

            <button type="submit">ì €ì¥</button>
        </form>

        <script>
            const form = document.getElementById('mapForm');
            const categorySelect = document.getElementById('place_category');
            const placeNameInput = document.getElementById('place_name');
            const placeAddressInput = document.getElementById('place_address');
            const placeDescriptionInput = document.getElementById('place_description');
            
            form.addEventListener('submit', function(event) {
                let isValid = true;
        
                // Check if the category select is valid
                if (!categorySelect.value) {
                    categorySelect.setAttribute('aria-invalid', 'true');
                    isValid = false;
                } else {
                    categorySelect.setAttribute('aria-invalid', 'false');
                }
        
                // Check if the place name is valid
                if (!placeNameInput.value.trim()) {
                    placeNameInput.setAttribute('aria-invalid', 'true');
                    isValid = false;
                } else {
                    placeNameInput.setAttribute('aria-invalid', 'false');
                }
        
                // Check if the address is valid
                if (!placeAddressInput.value.trim()) {
                    placeAddressInput.setAttribute('aria-invalid', 'true');
                    isValid = false;
                } else {
                    placeAddressInput.setAttribute('aria-invalid', 'false');
                }
        
                // Check if the description is valid
                if (!placeDescriptionInput.value.trim()) {
                    placeDescriptionInput.setAttribute('aria-invalid', 'true');
                    isValid = false;
                } else {
                    placeDescriptionInput.setAttribute('aria-invalid', 'false');
                }
        
                if (!isValid) {
                    event.preventDefault();  // Prevent form submission if invalid
                }
            });
        
            // Listen for changes in the category select field
            categorySelect.addEventListener('change', function() {
                if (categorySelect.value) {
                    categorySelect.setAttribute('aria-invalid', 'false');
                } else {
                    categorySelect.setAttribute('aria-invalid', 'true');
                }
            });
            
            // Real-time validation for place name
            placeNameInput.addEventListener('input', function() {
                if (placeNameInput.value.trim()) {
                    placeNameInput.setAttribute('aria-invalid', 'false');
                } else {
                    placeNameInput.setAttribute('aria-invalid', 'true');
                }
            });
        
            // Real-time validation for place address
            placeAddressInput.addEventListener('input', function() {
                if (placeAddressInput.value.trim()) {
                    placeAddressInput.setAttribute('aria-invalid', 'false');
                } else {
                    placeAddressInput.setAttribute('aria-invalid', 'true');
                }
            });
        
            // Real-time validation for place description
            placeDescriptionInput.addEventListener('input', function() {
                if (placeDescriptionInput.value.trim()) {
                    placeDescriptionInput.setAttribute('aria-invalid', 'false');
                } else {
                    placeDescriptionInput.setAttribute('aria-invalid', 'true');
                }
            });
            
            //////////////////////////////////
         	// ë³„ì  ê´€ë ¨ ë³€ìˆ˜ë“¤
            const cleanStars = document.querySelectorAll('.star-clean');
            const sceneStars = document.querySelectorAll('.star-scene');
            const independenceStars = document.querySelectorAll('.star-independence');
            const facilityStars = document.querySelectorAll('.star-facility');
            const editorStars = document.querySelectorAll('.star-editor');

            // ì ìˆ˜ ì…ë ¥ í•„ë“œ
            const cleanScoreInput = document.getElementById('place_cleanscore');
            const sceneScoreInput = document.getElementById('place_scenescore');
            const independenceScoreInput = document.getElementById('place_independencescore');
            const facilityScoreInput = document.getElementById('place_facilityscore');
            const editorScoreInput = document.getElementById('place_editorscore');

            // í‰ê· ê°’ ê³„ì‚° ë° ì—…ë°ì´íŠ¸ í•¨ìˆ˜
            function updateEditorScore() {
                const totalScore = (
                    parseFloat(cleanScoreInput.value) +
                    parseFloat(sceneScoreInput.value) +
                    parseFloat(independenceScoreInput.value) +
                    parseFloat(facilityScoreInput.value)
                ) / 4;

                editorScoreInput.value = totalScore.toFixed(1); // í‰ê· ê°’ì„ ì—ë””í„° í‰ì ìœ¼ë¡œ ì„¤ì •
                updateStars(editorStars, totalScore); // ì—ë””í„° ë³„ì ë„ ì—…ë°ì´íŠ¸
            }

            // ê° ë³„ í´ë¦­ ì‹œ ë³„ì  ì—…ë°ì´íŠ¸ í•¨ìˆ˜
            function updateStars(starElements, score) {
                starElements.forEach(star => {
                    if (star.getAttribute('data-value') <= score) {
                        star.src = 'https://cdn-icons-png.flaticon.com/128/1055/1055473.png'; // ì±„ì›Œì§„ ë³„
                    } else {
                        star.src = 'https://cdn-icons-png.flaticon.com/128/2377/2377878.png'; // ë¹ˆ ë³„
                    }
                });
            }

            // í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì • í•¨ìˆ˜
            function setStarClickListener(starElements, scoreInput) {
                starElements.forEach(star => {
                    star.addEventListener('click', function () {
                        const rating = this.getAttribute('data-value');
                        scoreInput.value = rating; // ì„ íƒí•œ ë³„ì˜ ì ìˆ˜ ì„¤ì •
                        updateStars(starElements, rating); // í•´ë‹¹ ë³„ì  ì—…ë°ì´íŠ¸
                        updateEditorScore(); // ì—ë””í„° ì ìˆ˜ ì—…ë°ì´íŠ¸
                    });
                });
            }

            // ê° ì ìˆ˜ì— ëŒ€í•œ í´ë¦­ ì´ë²¤íŠ¸ ì„¤ì •
            setStarClickListener(cleanStars, cleanScoreInput);
            setStarClickListener(sceneStars, sceneScoreInput);
            setStarClickListener(independenceStars, independenceScoreInput);
            setStarClickListener(facilityStars, facilityScoreInput);

			//////////////////////////////////
            // ì´ëª¨ì§€ ì„ íƒ ê¸°ëŠ¥ì„ í•¨ìˆ˜ë¡œ ë§Œë“­ë‹ˆë‹¤.
			function addEmojiSelector(targetTextareaId, emojiContainerId) {
			    const emojiContainer = document.getElementById(emojiContainerId);
			    const targetTextarea = document.getElementById(targetTextareaId);
			
			    // ì´ëª¨ì§€ ëª©ë¡ì„ ë™ì ìœ¼ë¡œ ì¶”ê°€
			    const emojis = ['ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜', 'ğŸ˜†', 'ğŸ˜…', 'ğŸ˜‚', 'ğŸ¤£', 'ğŸ˜Š', 'ğŸ˜‡', 'ğŸ™‚', 'ğŸ˜­', 
			    	'ğŸ¶', 'ğŸ±', 'ğŸ­', 'ğŸ¹', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ', 'âš½', 'ğŸ€', 'âš¾', 'ğŸ¾', 'ğŸ', 'ğŸ±', 
			    	'ğŸ“', 'ğŸ¸', 'ğŸŠâ€â™‚ï¸', 'ğŸ“±', 'ğŸ“¸', 'ğŸ“½ï¸', 'ğŸï¸', 'ğŸ“', 'â˜ï¸', 'ğŸ“º',  'ğŸ™ï¸', 'â°', 'ğŸ”‘', 'ğŸ’¡',
			    	'ğŸ“…', 'ğŸ’°', 'ğŸ€'];
			    emojiContainer.innerHTML = '';  // ê¸°ì¡´ ë‚´ìš©ì„ ì´ˆê¸°í™”
			    emojis.forEach(emoji => {
			        const span = document.createElement('span');
			        span.textContent = emoji;
			        span.classList.add('emoji');
			        emojiContainer.appendChild(span);
			    });
			
			    // ì´ëª¨ì§€ë¥¼ í´ë¦­í•˜ë©´ textareaì— ì…ë ¥ë˜ë„ë¡ í•˜ëŠ” ì´ë²¤íŠ¸ ì¶”ê°€
			    emojiContainer.addEventListener('click', function(event) {
			        if (event.target.classList.contains('emoji')) {
			            const emoji = event.target.textContent;
			            targetTextarea.value += emoji;  // ì´ëª¨ì§€ë¥¼ í…ìŠ¤íŠ¸ì— ì¶”ê°€
			        }
			    });
			}
			
			// ì£¼ìš”ì‚¬í•­ textareaì—ë„ ì´ëª¨ì§€ ì„ íƒ ê¸°ëŠ¥ì„ ì¬ì‚¬ìš© ê°€ëŠ¥
			addEmojiSelector('place_keypoint', 'emoji-container2');
			
			// ì£¼ì˜ì‚¬í•­ textareaì—ë„ ì´ëª¨ì§€ ì„ íƒ ê¸°ëŠ¥ì„ ì¬ì‚¬ìš© ê°€ëŠ¥
			addEmojiSelector('place_precaution', 'emoji-container3');
			
        </script>

    </main>
</body>
</html>
